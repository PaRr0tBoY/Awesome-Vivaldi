/*
 * VivalArc Test CSS
 * Side Tabbar & Tab Stack Indicator Features
 * Version: 1.0.0
 * Updated: 2025-09-20
 *
 * 测试说明：
 * 1. 需要在 Vivaldi 设置中将标签栏位置设置为"左侧"或"右侧"
 * 2. 启用"标签后着色"设置为"关闭"
 * 3. 在 vivaldi://experiments 中启用"允许CSS修改"
 * 4. 重启Vivaldi生效
 */

:root {
  --window-border: 4px;
  --tab-padding: calc(var(--window-border) / 2);
  --colorToviTransparent: transparent;
}

/* ========================================
   侧边标签栏高级功能
   ======================================== */

/* 侧边标签栏容器透明背景 */
.tabs-left .tabbar-wrapper,
.tabs-right .tabbar-wrapper {
  background-color: transparent;
  overflow: visible;
}

/* 自适应内边距 - 为没有 .tab-small 子元素的标签栏容器设置内边距 */
.tabs-left .inner > .tabbar-wrapper:not(:has(.tab-small)),
.tabs-right .inner > .tabbar-wrapper:not(:has(.tab-small)) {
  margin: 0 var(--tab-padding);
}

/* 折叠箭头宽度优化 - 根据容器宽度和内边距动态计算 */
.tabs-left .accordion-toggle-arrow,
.tabs-right .accordion-toggle-arrow {
  max-width: calc(var(--Width) - 16px + (var(--tab-padding) * 2));
}

/* 标签字体颜色设置 */
.tabs-left .tab-position .tab,
.tabs-right .tab-position .tab {
  color: var(--colorFg);
}

/* 工作区按钮与标签栏组合优化 - 添加顶部间距 */
.tabbar-workspace-button + #tabs-tabbar-container.left,
.tabbar-workspace-button + #tabs-tabbar-container.right {
  padding-top: 4px;
}

/* 透明标签栏容器 */
#browser.transparent-tabbar #tabs-tabbar-container.left,
#browser.transparent-tabbar #tabs-tabbar-container.right,
#browser:not(.transparent-tabbar) #tabs-tabbar-container {
  background: var(--colorToviTransparent);
  border: none;
  box-shadow: none;
}

/* 标签栏底部内边距 */
#browser.tabs-left .inner > .tabbar-wrapper,
#browser.tabs-right .inner > .tabbar-wrapper {
  padding-bottom: var(--window-border);
}

/* ========================================
   标签堆栈指示器
   ======================================== */

/* 标签指示器基础样式 - 仅在"标签后着色关闭"模式下生效 */
.color-behind-tabs-off .tab-indicator {
  background-color: var(--colorAccentBgAlpha);
}

.color-behind-tabs-off .tab-indicator:hover {
  background-color: var(--colorAccentBg);
}

.color-behind-tabs-off .tab-indicator.active {
  background-color: var(--colorAccentBg);
}

/* 标签组内活跃标签的指示器 */
.color-behind-tabs-off
  .tab.active
  + .tab-group-indicator
  .tab-indicator.active {
  background-color: var(--colorAccentBg);
}

/* 标签堆栈容器透明化 */
#browser:not(.tabs-top):not(.tabs-bottom).color-behind-tabs-off
  #tabs-subcontainer.left,
#browser:not(.tabs-top):not(.tabs-bottom).color-behind-tabs-off
  #tabs-subcontainer.right {
  box-shadow: none;
}

#browser:not(.tabs-top):not(.tabs-bottom).color-behind-tabs-off
  #tabs-subcontainer,
#browser:not(.tabs-top):not(.tabs-bottom).transparent-tabbar
  #tabs-subcontainer {
  background-color: transparent;
}

/* ========================================
   调试和测试辅助功能
   ======================================== */

/* 调试用边框 - 可以启用来查看元素边界 */
/*
.tabs-left .tabbar-wrapper,
.tabs-right .tabbar-wrapper,
#tabs-tabbar-container.left,
#tabs-tabbar-container.right {
  border: 1px dashed red !important;
}
 */

/* 调用信息 - 帮助理解哪些样式正在生效 */
/*
.tabs-left .tabbar-wrapper::before,
.tabs-right .tabbar-wrapper::before {
  content: "Tabbar Wrapper";
  position: absolute;
  top: -20px;
  left: 0;
  font-size: 10px;
  color: red;
  background: yellow;
  padding: 2px;
}
 */

/* ========================================
   使用说明
   ======================================== */

/*
 * 🎯 功能测试指南：
 *
 * 1. 侧边标签栏滚动条隐藏：
 *    - 当标签过多时，滚动条会自动隐藏
 *    - 可通过鼠标滚轮或触摸板滚动
 *
 * 2. 自适应内边距：
 *    - 调整 --window-border 变量观察间距变化
 *    - 标签会自动适应窗口边框宽度
 *
 * 3. 折叠箭头优化：
 *    - 工作区折叠箭头会根据容器宽度自动调整
 *    - 防止溢出和视觉不协调
 *
 * 4. 标签堆栈指示器：
 *    - 在设置中关闭"标签后着色"查看效果
 *    - 标签分组指示器会使用半透明背景
 *    - 悬停时变为实色背景
 *
 * 5. 组合优化：
 *    - 工作区按钮和标签栏之间有4px间距
 *    - 整体布局更加协调统一
 *
 * ⚠️  注意事项：
 *    - 仅在侧边标签栏布局下生效
 *    - 需要重启Vivaldi才能看到效果
 *    - 某些功能可能需要特定的Vivaldi设置
 */
