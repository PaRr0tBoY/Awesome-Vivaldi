/* ===============================
   Dialog 基本与 Arc Peek 动画
   =============================== */

/* 顶层遮罩 - 只覆盖网页内容区域，不覆盖工具栏 */
.dialog-container {
  z-index: 500; /* 进一步降低z-index */
  position: absolute; /* 改为 absolute，相对于父容器定位 */
  inset: 0;
  background-color: rgba(0, 0, 0, 0);
  backdrop-filter: blur(0px);
  transition:
    backdrop-filter 0.28s cubic-bezier(0.2, 0.8, 0.2, 1),
    background-color 0.28s cubic-bezier(0.2, 0.8, 0.2, 1);
  pointer-events: none; /* 初始状态不拦截点击 */
}

.dialog-container.show-overlay {
  background-color: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(2px);
  pointer-events: auto; /* 显示时允许点击 */
}

/* dialog-tab 基础样式 */
.dialog-tab {
  position: absolute;
  display: flex;
  flex-direction: column;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.35);
  border-radius: var(--radius);
  overflow: hidden;
  background: var(--colorBg);
  pointer-events: auto;
  z-index: 501; /* 相对较低的z-index */
}

/* 移除状态类，改由 JavaScript 通过 Web Animations API 控制 */

/* 背景网页缩放效果 - 只影响网页内容，不影响工具栏 */
.webpageview webview,
.webpageview .webpage {
  transition: transform 0.32s cubic-bezier(0.16, 1, 0.3, 1) !important;
  transform-origin: center center;
}

body.dialog-open .webpageview webview,
body.dialog-open .webpageview .webpage {
  transform: scale(0.985) !important;
}

/* Progress Bar 样式保持不变 */
@keyframes dialog-tab-animate-progress-bar {
  0% {
    left: -100%;
  }
  100% {
    left: 100%;
  }
}

.dialog-tab .progress-bar {
  height: 5px;
  max-width: calc(100% - var(--radius) * 1.5);
  left: calc(var(--radius) * 0.75);
  background-color: #0080ff;
  border-radius: var(--radius);
  transition: width 0.2s linear;
  overflow: hidden;
  position: relative;
  visibility: hidden; /* 默认隐藏 */
}

.dialog-tab .progress-bar[style*="width: 100%"]:after {
  content: "";
  width: 50%;
  height: 100%;
  background-image: linear-gradient(
    to right,
    rgba(255, 255, 255, 0.5),
    rgba(255, 255, 255, 0.8),
    rgba(255, 255, 255, 0.5)
  );
  position: absolute;
  top: 0;
  left: -100%;
  animation: dialog-tab-animate-progress-bar 1.5s linear infinite;
}

/* Options Container */
.dialog-tab .options-container {
  display: flex;
  height: 35px;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  color: white;
  z-index: 1160;
  /* 透明度通过 JavaScript 控制 */
}

/* WebView 样式 */
.dialog-tab webview {
  position: relative;
  flex: 1;
  overflow: hidden;
  border-radius: var(--radius);
  background: var(--colorBorder);
}

/* 响应式设计：在小屏幕上调整对话框大小 */
@media (max-width: 768px) {
  .dialog-tab.expanded {
    /* 小屏幕上占用更多空间 */
    max-width: 95% !important;
    max-height: 90% !important;
  }
}

/* 高对比度模式支持 */
@media (prefers-contrast: high) {
  .dialog-container.show-overlay {
    background-color: rgba(0, 0, 0, 0.8);
  }

  .dialog-tab {
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.8);
    border: 1px solid var(--colorBorder);
  }
}

/* 减少动效模式 */
@media (prefers-reduced-motion: reduce) {
  .dialog-tab,
  .dialog-container,
  #browser #webpage-stack,
  .inner #web-stack {
    transition: none !important;
  }

  .dialog-tab .options-container {
    transition: none !important;
  }
}
