:root {
  --mod-gap: 5px;
  --tabbar-border-radius: 17px;
  --tabs-container-collapse-width: 7px; /* min width of main tabbar should not set lower than 6px, which will cause weird issue. */
  --tabs-container-expand-width: 300px;
  --tabs-subcontainer-collapse-width: 42px;
  --tabs-subcontainer-expand-width: 335px;
  --fast-animation-speed: 70ms;
  --medium-animation-speed: 140ms;
  --smooth-animation-speed: 280ms;
  --transition-delay-time: 60ms;
  --tabs-container-bg-color: rgba(25, 30, 25, 0.9);
  --tabs-subcontainer-bg-color: rgba(29, 40, 33, 0.81);
}
/* ========================================
   AUTO-HIDE TABBAR
   ======================================== */
/* Main Tabbar*/

/* Adjust hide animation and width of main tabbar here */
/* I set its width very small since I think this has more of a "hidden" vibe,
and I figure people may want to focus more on sub-stack when they're working on a certain subject
with a tab-stack. Which is why we need tab-stack no? */
#tabs-container.right,
#tabs-container.left {
  min-width: var(--tabs-container-collapse-width) !important;
  max-width: var(--tabs-container-collapse-width) !important;
  transition:
    min-width var(--smooth-animation-speed) ease-out,
    max-width var(--smooth-animation-speed) ease-out !important;
  transition-delay: 0ms !important;
  margin-top: -6px; /*You might not want this*/
  padding-top: var(--mod-gap) !important; /*You might not want this*/
  padding-bottom: var(--mod-gap) !important; /*You might not want this*/
  padding-right: var(--mod-gap) !important; /*You might not want this*/
  background-color: var(
    --tabs-container-bg-color
  ) !important; /* Adjust the color here */
  box-sizing: border-box !important;
  position: relative !important;
}

/* Rounded corners: Adjust based on tab bar position and element order */
/* Rounded corners for right tab bar */
#tabs-tabbar-container.right #tabs-container.right {
  border-radius: 0px var(--tabbar-border-radius) var(--tabbar-border-radius) 0px !important;
}

#tabs-tabbar-container.right #tabs-subcontainer.right {
  border-radius: var(--tabbar-border-radius) 0px 0px var(--tabbar-border-radius) !important;
}

/* Rounded corners for left tab bar */
#tabs-tabbar-container.left #tabs-container.left {
  border-radius: var(--tabbar-border-radius) 0px 0px var(--tabbar-border-radius) !important;
}

#tabs-tabbar-container.left #tabs-subcontainer.left {
  border-radius: 0px var(--tabbar-border-radius) var(--tabbar-border-radius) 0px !important;
}

/* Rounded corners when only main tab bar is present */
#tabs-tabbar-container.right:not(:has(#tabs-subcontainer))
  #tabs-container.right {
  border-radius: var(--tabbar-border-radius) !important;
}

#tabs-tabbar-container.left:not(:has(#tabs-subcontainer)) #tabs-container.left {
  border-radius: var(--tabbar-border-radius) !important;
}

/* Enhanced conditions for keeping tabbar expanded */
/* When StackEditor modal is present or AddressField is focused */
body:has(.button-popup) #tabs-container.right,
body:has(.button-popup) #tabs-container.left,
body:has(.UrlBar-AddressField:focus-within) #tabs-container.right,
body:has(.UrlBar-AddressField:focus-within) #tabs-container.left {
  min-width: var(--tabs-container-expand-width) !important;
  max-width: var(--tabs-container-expand-width) !important;
  padding-top: var(--mod-gap) !important;
  padding-bottom: var(--mod-gap) !important;
  padding-right: var(--mod-gap) !important;
  background-color: var(--tabs-container-bg-color) !important;
  box-sizing: border-box !important;
}

/* Adjust expand width of main tabbar here */
#tabs-container.left:hover,
#tabs-container.right:hover {
  min-width: var(--tabs-container-expand-width) !important;
  max-width: var(--tabs-container-expand-width) !important;
  padding-top: var(--mod-gap) !important; /*You might not want this*/
  padding-bottom: var(--mod-gap) !important; /*You might not want this*/
  padding-right: var(--mod-gap) !important; /*You might not want this*/
  background-color: var(
    --tabs-container-bg-color
  ) !important; /* Adjust the color here */
  box-sizing: border-box !important;
  /* transition-delay: 60ms !important; */
}

/* SubStack / Secondary Tabbar */

/* Fix bouncing issue: Add transform transition animation to tabs-subcontainer */
#tabs-subcontainer.right,
#tabs-subcontainer.left {
  min-width: var(--tabs-subcontainer-collapse-width) !important;
  max-width: var(--tabs-subcontainer-collapse-width) !important;
  transition:
    min-width var(--smooth-animation-speed) ease-out,
    max-width var(--smooth-animation-speed) ease-out,
    transform var(--smooth-animation-speed) ease-out !important;
  /* transition-delay: var(--fast-animation-speed) !important; */
  margin-top: -6px !important; /*You might not want this*/
  padding-top: var(--mod-gap) !important; /*You might not want this*/
  padding-bottom: var(--mod-gap) !important; /*You might not want this*/
  background-color: var(
    --tabs-subcontainer-bg-color
  ) !important; /* Adjust the color here */
  box-sizing: border-box !important;
  /* Ensure subcontainer stays in correct position */
  position: relative !important;
  will-change: transform !important;
}

/* Adjust expand width of Secondary tabbar here */
#tabs-subcontainer.left:hover,
#tabs-subcontainer.right:hover {
  min-width: var(--tabs-subcontainer-expand-width) !important;
  max-width: var(--tabs-subcontainer-expand-width) !important;
  transition:
    min-width var(--smooth-animation-speed) ease-out,
    max-width var(--smooth-animation-speed) ease-out,
    transform var(--smooth-animation-speed) ease-out !important;
  transition-delay: 0ms !important;
  margin-top: -6px;
  padding-top: var(--mod-gap) !important; /*You might not want this*/
  padding-bottom: var(--mod-gap) !important; /*You might not want this*/
  background-color: var(
    --tabs-subcontainer-bg-color
  ) !important; /* Adjust the color here */
  box-sizing: border-box !important;
}

/* Tab bar styling */
.tabbar-workspace-button {
  width: 100% !important;
}

/* Fix container bouncing: Add smooth transition to overall container */
#tabs-tabbar-container.left,
#tabs-tabbar-container.right {
  width: auto !important;
  min-width: var(
    --tabs-container-collapse-width
  ) !important; /* main stack width when it fold */
  max-width: calc(
    var(--tabs-container-expand-width)+var(--tabs-subcontainer-collapse-width)
  ) !important; /* Combine total of expand width of stack and substack when one of them is hovered */
  background-color: transparent !important;
  background-image: none !important;
  border: none !important;
  border-radius: var(--tabbar-border-radius) !important;
  /*border-color: black !important;
  border-width: 1px !important;*/
  /* Written By Claude */
  box-shadow: none !important;
  box-sizing: border-box !important;
  /* Add transition animation to overall container to reduce bouncing effect */
  transition:
    width var(--smooth-animation-speed) ease-out,
    min-width var(--smooth-animation-speed) ease-out,
    max-width var(--smooth-animation-speed) ease-out !important;
  /* Ensure container layout stability - Fix tab bar order */
  display: flex !important;
  flex-direction: row !important;
  align-items: stretch !important;
}

/* Correct tab bar order: When right tab bar, main tab bar is on the right; when left tab bar, main tab bar is on the left */
/* Right tab bar: Sub tab bar on left, main tab bar on right */
#tabs-tabbar-container.right #tabs-subcontainer.right {
  order: 1 !important;
}

#tabs-tabbar-container.right #tabs-container.right {
  order: 2 !important;
}

/* Left tab bar: Main tab bar on left, sub tab bar on right */
#tabs-tabbar-container.left #tabs-container.left {
  order: 1 !important;
}

#tabs-tabbar-container.left #tabs-subcontainer.left {
  order: 2 !important;
}

/* I hate newtab button. But if you have the opposite opinion,replace below codes with these

.button-toolbar.newtab{
  left: 0px !important;
  width: 150px;
}

And of course you don't need those lockers icon when your tabbar expand on hover so here's how you hide em.

.button-toolbar.tabs-locked,
.button-toolbar.tabs-unlocked {
  display: none !important;
}
*/
.button-toolbar.newtab,
.button-toolbar.tabs-locked,
.button-toolbar.tabs-unlocked {
  display: none !important;
} /* Codeblock to replace of*/

.toolbar.toolbar-tabbar-after.toolbar-large.toolbar-droptarget {
  margin-bottom: -35px !important;
}
/* ========================================
   HIDE ELEMENTS ON HOVER
   ======================================== */

/*
Codes below is important. Help avoid issue when
1. Create a tab stack
2. Dissolve a tab stack
*/
/* Hide tab-strip when tabs-container is not hovered */
.tab-strip.overflow {
  display: none !important;
}

/* Show tab-strip when tabs-container is hovered or special conditions met */
#tabs-container:hover .tab-strip.overflow,
body:has(.button-popup) #tabs-container .tab-strip.overflow,
body:has(.UrlBar-AddressField:focus-within)
  #tabs-container
  .tab-strip.overflow {
  display: block !important;
  /*animation: fadeInBlock 300ms ease-out !important;*/
}

/* Animation for smooth appearance when display changes */
/*@keyframes fadeInBlock {
  from {
    opacity: 0;
    transform: translateX(-10px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}*/

/* show tabs when hover */
#tabs-container.right:not(:hover) .tab,
#tabs-container.left:not(:hover) .tab,
#tabs-container.right:not(:hover) .tab-position,
#tabs-container.left:not(:hover) .tab-position,
#tabs-container.right:not(:hover) .separator,
#tabs-container.left:not(:hover) .separator {
  opacity: 0 !important;
  pointer-events: none !important;
  transition: opacity var(--smooth-animation-speed) ease-in !important;
  transition-delay: var(--transition-delay-time) !important;
}

/* Show tabs when popup is present or AddressField is focused */
body:has(.button-popup) #tabs-container.right:not(:hover) .tab,
body:has(.button-popup) #tabs-container.left:not(:hover) .tab,
body:has(.button-popup) #tabs-container.right:not(:hover) .tab-position,
body:has(.button-popup) #tabs-container.left:not(:hover) .tab-position,
body:has(.button-popup) #tabs-container.right:not(:hover) .separator,
body:has(.button-popup) #tabs-container.left:not(:hover) .separator,
body:has(.UrlBar-AddressField:focus-within)
  #tabs-container.right:not(:hover)
  .tab,
body:has(.UrlBar-AddressField:focus-within)
  #tabs-container.left:not(:hover)
  .tab,
body:has(.UrlBar-AddressField:focus-within)
  #tabs-container.right:not(:hover)
  .tab-position,
body:has(.UrlBar-AddressField:focus-within)
  #tabs-container.left:not(:hover)
  .tab-position,
body:has(.UrlBar-AddressField:focus-within)
  #tabs-container.right:not(:hover)
  .separator,
body:has(.UrlBar-AddressField:focus-within)
  #tabs-container.left:not(:hover)
  .separator {
  opacity: 1 !important;
  pointer-events: auto !important;
  transition: opacity var(--smooth-animation-speed) ease-out !important;
  transition-delay: var(--transition-delay-time) !important;
}

#tabs-container.right:hover .tab,
#tabs-container.left:hover .tab,
#tabs-container.right:hover .tab-position,
#tabs-container.left:hover .tab-position,
#tabs-container.right:hover .separator,
#tabs-container.left:hover .separator {
  opacity: 1 !important;
  pointer-events: auto !important;
  transition: opacity var(--smooth-animation-speed) ease-out !important;
  transition-delay: var(--transition-delay-time) !important;
}

/*
Show toolbar buttons when popup is present or AddressField is focused
*/
/*#tabs-container.right:not(:hover) .UrlBar-AddressField,
#tabs-container.left:not(:hover) .UrlBar-AddressField,*/
/*#tabs-container.right:not(:hover) .button-toolbar.toolbar-spacer-flexible,
#tabs-container.left:not(:hover) .button-toolbar.toolbar-spacer-flexible,
#tabs-container.right:not(:hover) .ToolbarButton-Button,
#tabs-container.left:not(:hover) .ToolbarButton-Button,*/
#tabs-container.right:not(:hover) .toolbar-extensions,
#tabs-container.left:not(:hover) .toolbar-extensions,
#tabs-container.right:not(:hover)
  .toolbar.toolbar-tabbar-after.toolbar-large.toolbar-droptarget,
#tabs-container.left:not(:hover)
  .toolbar.toolbar-tabbar-after.toolbar-large.toolbar-droptarget,
#tabs-container.right:not(:hover)
  .toolbar.toolbar-tabbar-before.toolbar-large.toolbar-droptarget,
#tabs-container.left:not(:hover)
  .toolbar.toolbar-tabbar-before.toolbar-large.toolbar-droptarget {
  max-width: 0 !important;
  min-width: 0 !important;
  width: 0 !important;
  height: 0 !important;
  padding: 0 !important;
  border: 0 !important;
  overflow: hidden !important;
  transition:
    min-width var(--smooth-animation-speed) ease-out,
    max-width var(--smooth-animation-speed) ease-out,
    width var(--smooth-animation-speed) ease-out,
    height var(--smooth-animation-speed) ease-out,
    padding var(--smooth-animation-speed) ease-out !important;
  transition-delay: var(--transition-delay-time) !important;
}

#tabs-container.right:hover .toolbar-extensions,
#tabs-container.left:hover .toolbar-extensions {
  max-width: 300px !important;
  transition: max-width var(--smooth-animation-speed) ease-out !important;
  transition-delay: var(--transition-delay-time) !important;
}

/*#tabs-container:not(:hover) .toolbar-extensions {
  max-width: 0 !important;
  transition: max-width var(--smooth-animation-speed) ease-out 60ms !important;
}

#tabs-container:hover .toolbar-extensions {
  max-width: 300px !important;
  transition: max-width var(--smooth-animation-speed) ease-out 60ms !important;
}*/

/* Show toolbar elements when popup is present or AddressField is focused */
/*body:has(.button-popup)
  #tabs-container.right:not(:hover)
  .button-toolbar.toolbar-spacer-flexible,
body:has(.button-popup)
  #tabs-container.left:not(:hover)
  .button-toolbar.toolbar-spacer-flexible,
body:has(.button-popup) #tabs-container.right:not(:hover) .ToolbarButton-Button,
body:has(.button-popup) #tabs-container.left:not(:hover) .ToolbarButton-Button,*/
/*body:has(.UrlBar-AddressField:focus-within)
  #tabs-container.right:not(:hover)
  .button-toolbar.toolbar-spacer-flexible,
body:has(.UrlBar-AddressField:focus-within)
  #tabs-container.left:not(:hover)
  .button-toolbar.toolbar-spacer-flexible,
body:has(.UrlBar-AddressField:focus-within)
  #tabs-container.right:not(:hover)
  .ToolbarButton-Button,
body:has(.UrlBar-AddressField:focus-within)
  #tabs-container.left:not(:hover)
  .ToolbarButton-Button,*/
/*==========================================================================*/
body:has(.button-popup)
  #tabs-container.right:not(:hover)
  .toolbar.toolbar-tabbar-after.toolbar-large.toolbar-droptarget,
body:has(.button-popup)
  #tabs-container.left:not(:hover)
  .toolbar.toolbar-tabbar-after.toolbar-large.toolbar-droptarget,
/*==========================================================================*/
body:has(.button-popup)
  #tabs-container.right:not(:hover)
  .toolbar.toolbar-tabbar-before.toolbar-large.toolbar-droptarget,
body:has(.button-popup)
  #tabs-container.left:not(:hover)
  .toolbar.toolbar-tabbar-before.toolbar-large.toolbar-droptarget,
/*==========================================================================*/
/*==========================================================================*/
body:has(.UrlBar-AddressField:focus-within)
  #tabs-container.right:not(:hover)
  .toolbar.toolbar-tabbar-after.toolbar-large.toolbar-droptarget,
body:has(.UrlBar-AddressField:focus-within)
  #tabs-container.left:not(:hover)
  .toolbar.toolbar-tabbar-after.toolbar-large.toolbar-droptarget,
/*==========================================================================*/
body:has(.UrlBar-AddressField:focus-within)
  #tabs-container.right:not(:hover)
  .toolbar.toolbar-tabbar-before.toolbar-large.toolbar-droptarget,
body:has(.UrlBar-AddressField:focus-within)
  #tabs-container.left:not(:hover)
  .toolbar.toolbar-tabbar-before.toolbar-large.toolbar-droptarget
/*==========================================================================*/ {
  min-width: auto !important;
  max-width: 300px !important;
  width: initial !important;
  height: initial !important;
  padding: initial !important;
  border: initial !important;
  overflow: visible !important;
  transition-delay: var(--transition-delay-time) !important;
}

/*==========================================================================*/
body:has(.UrlBar-AddressField:focus-within)
  #tabs-container.right:not(:hover)
  .toolbar-extensions,
body:has(.UrlBar-AddressField:focus-within)
  #tabs-container.left:not(:hover)
  .toolbar-extensions,
/*==========================================================================*/
body:has(.button-popup) #tabs-container.right:not(:hover) .toolbar-extensions,
body:has(.button-popup) #tabs-container.left:not(:hover) .toolbar-extensions {
  min-width: auto !important;
  max-width: 300px !important;
  width: initial !important;
  height: initial !important;
  padding: initial !important;
  border: initial !important;
  transition-delay: var(--transition-delay-time) !important;
}
/*==========================================================================*/
/* Show toolbar and URL field elements when hovered */
/*#tabs-container.right:hover .ToolbarButton-Button,
#tabs-container.left:hover .ToolbarButton-Button,
#tabs-container.right:hover .UrlBar-AddressField .toolbar,
#tabs-container.left:hover .UrlBar-AddressField .toolbar,
#tabs-container.right:hover .UrlBar-AddressField,
#tabs-container.left:hover .UrlBar-AddressField,
#tabs-container.right:hover .UrlBar-AddressField .button-toolbar,
#tabs-container.left:hover .UrlBar-AddressField .button-toolbar {
  min-width: auto !important;
  width: auto !important;
  height: auto !important;
  padding: initial !important;
  border: initial !important;
  overflow: visible !important;
}*/

/* ========================================
   FLOATING TABBAR
   ======================================== */
/* If you want the expanded tabbar floating on the website instead of squeezing it, just add the following css to the css above */
/* But read the comments before you do */

#main > .inner > div:has(#tabs-tabbar-container.right),
#main > .inner > div:has(#tabs-tabbar-container.left) {
  position: absolute;
  top: 0;
  z-index: 2;
  opacity: 1;
  background-color: transparent !important;
  background-image: none !important;
  height: 100% !important;
}

#main > .inner > div:has(#tabs-tabbar-container.right) {
  right: 0;
}

#main > .inner > div:has(#tabs-tabbar-container.left) {
  left: 0;
}

#browser.transparent-tabbar
  .inner
  > div:has(#tabs-tabbar-container:is(.left, .right)) {
  background-color: transparent !important;
  backdrop-filter: none !important;
}

/*=================== Webpage stack margins - Auto Detection ===================*/

/* Auto-detect tabbar position and apply appropriate margins */

/* Right tabbar margins */
#browser:not(.fullscreen):has(#tabs-tabbar-container.right)
  .inner
  #webpage-stack {
  margin-right: var(--tabs-container-collapse-width);
  transition: margin-right var(--smooth-animation-speed) ease-out !important;
}

#browser:not(.fullscreen)
  :has(#tabs-tabbar-container.right)
  .inner:has(#tabs-subcontainer:is(.left, .right))
  #webpage-stack {
  margin-right: calc(
    var(--tabs-container-collapse-width) +
      var(--tabs-subcontainer-collapse-width)
  );
}

#browser:not(.fullscreen) #tabs-tabbar-container.right ~ #webpage-stack {
  margin-right: var(--tabs-container-collapse-width);
}

#browser:not(.fullscreen)
  #tabs-tabbar-container.right
  ~ #webpage-stack:has(#tabs-subcontainer.right) {
  margin-right: calc(
    var(--tabs-container-collapse-width) +
      var(--tabs-subcontainer-collapse-width)
  );
}

/* Left tabbar margins */
#browser:not(.fullscreen):has(#tabs-tabbar-container.left)
  .inner
  #webpage-stack {
  margin-left: var(--tabs-container-collapse-width);
  transition: margin-left var(--smooth-animation-speed) ease-out !important;
}

#browser:not(.fullscreen)
  :has(#tabs-tabbar-container.left)
  .inner:has(#tabs-subcontainer:is(.left, .right))
  #webpage-stack {
  margin-left: calc(
    var(--tabs-container-collapse-width) +
      var(--tabs-subcontainer-collapse-width)
  );
}

#browser:not(.fullscreen) #tabs-tabbar-container.left ~ #webpage-stack {
  margin-left: var(--tabs-container-collapse-width);
}

#browser:not(.fullscreen)
  #tabs-tabbar-container.left
  ~ #webpage-stack:has(#tabs-subcontainer.left) {
  margin-left: calc(
    var(--tabs-container-collapse-width) +
      var(--tabs-subcontainer-collapse-width)
  );
}
